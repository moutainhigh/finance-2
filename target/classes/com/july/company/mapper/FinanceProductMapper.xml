<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.july.company.mapper.FinanceProductMapper">

    <select id="getFinanceStockProduct" resultType="com.july.company.vo.finance.FinanceStockProductVo">
        select ffp.id,ffp.title,ffp.mechanism,ffpd.industryDirect,ffpd.financeQuota,ffpd.financeState from
        fc_finance_product ffp,fc_finance_stock_detail ffpd
        where
        ffp.id = ffpd.productId
        and ffp.financeType = 0
        and ffp.deleted = 0
        <if test="param.productIds != null and param.productIds != ''">
            and find_in_set(ffp.id,#{param.productIds})
        </if>
        <!--融资额度-->
        <if test="param.financeQuota != null and param.financeQuota != ''">
            and ffpd.financeQuota = #{param.financeQuota}
        </if>
        <!--融资阶段-->
        <if test="param.financeState != null and param.financeState != ''">
            and ffpd.financeState = #{param.financeState}
        </if>
        <!--行业方向-->
        <if test="param.industryDirect != null and param.industryDirect != ''">
            and ffpd.industryDirect = #{param.industryDirect}
        </if>
        <!--注册地址-->
        <if test="param.registerAddress != null and param.registerAddress != ''">
            and ffpd.registerAddress = #{param.registerAddress}
        </if>
        <!--营业收入-->
        <if test="param.business != null and param.business != ''">
            and ffpd.business = #{param.business}
        </if>
        <!--员工人数-->
        <if test="param.staffCount != null and param.staffCount != ''">
            and ffpd.staffCount = #{param.staffCount}
        </if>
        <!--市场占有率-->
        <if test="param.marketOccupyRate != null and param.marketOccupyRate != ''">
            and ffpd.marketOccupyRate = #{param.marketOccupyRate}
        </if>
        <!--评定名称-->
        <if test="param.evaluateName != null and param.evaluateName != ''">
            and ffpd.evaluateName = #{param.evaluateName}
        </if>
        <!--产品阶段-->
        <if test="param.productState != null and param.productState != ''">
            and ffpd.productState = #{param.productState}
        </if>
        <!--产品毛利率-->
        <if test="param.productRate != null and param.productRate != ''">
            and ffpd.productRate = #{param.productRate}
        </if>
        <!--实控人创业经历-->
        <if test="param.experience != null and param.experience != ''">
            and ffpd.experience = #{param.experience}
        </if>
        <!--发明专利数-->
        <if test="param.patentCount != null and param.patentCount != ''">
            and ffpd.patentCount = #{param.patentCount}
        </if>
        <!--股东背景-->
        <if test="param.shareholder != null and param.shareholder != ''">
            and ffpd.shareholder = #{param.shareholder}
        </if>
        <!--股东累计投入资金-->
        <if test="param.capitals != null and param.capitals != ''">
            and ffpd.capitals = #{param.capitals}
        </if>
        <!--公司竞争优势-->
        <if test="param.advantage != null and param.advantage != ''">
            and ffpd.advantage = #{param.advantage}
        </if>
        <!--历史创业企业状态-->
        <if test="param.companyStatus != null and param.companyStatus != ''">
            and ffpd.companyStatus = #{param.companyStatus}
        </if>
        <!--市场容量-->
        <if test="param.marketCapacity != null and param.marketCapacity != ''">
            and ffpd.marketCapacity = #{param.marketCapacity}
        </if>
        <!--市场预期容量增长率-->
        <if test="param.marketAddRate != null and param.marketAddRate != ''">
            and ffpd.marketAddRate = #{param.marketAddRate}
        </if>
        <!--市场占有率-->
        <if test="param.marketOccupyRate != null and param.marketOccupyRate != ''">
            and ffpd.marketOccupyRate = #{param.marketOccupyRate}
        </if>
        <!--是否接受回购条款-->
        <if test="param.boolBuyBack != null and param.boolBuyBack != ''">
            and ffpd.boolBuyBack = #{param.boolBuyBack}
        </if>
        <!--预计上市时间-->
        <if test="param.timeToMarket != null and param.timeToMarket != ''">
            and ffpd.timeToMarket = #{param.timeToMarket}
        </if>
        <!--营业收入增长率-->
        <if test="param.businessAddRate != null and param.businessAddRate != ''">
            and ffpd.businessAddRate = #{param.businessAddRate}
        </if>
        <!--过往融资金额-->
        <if test="param.oldFinanceQuota != null and param.oldFinanceQuota != ''">
            and ffpd.oldFinanceQuota = #{param.oldFinanceQuota}
        </if>
        <!--净利率-->
        <if test="param.netInterestRate != null and param.netInterestRate != ''">
            and ffpd.netInterestRate = #{param.netInterestRate}
        </if>
        <!--目标客户-->
        <if test="param.targetCustomer != null and param.targetCustomer != ''">
            and ffpd.targetCustomer = #{param.targetCustomer}
        </if>
        <!--名称或机构名称-->
        <if test="param.mechanismOrProduct != null and param.mechanismOrProduct != ''">
            and (
            ffp.mechanism like concat('%',#{param.mechanismOrProduct},'%')
            or
            ffp.title like concat('%',#{param.mechanismOrProduct},'%')
            )
        </if>
        <if test="param.orderByField == null">
            order by ffpd.financeQuota desc
        </if>
        <if test="param.orderByField == 0">
            order by ffpd.financeQuota
        </if>
        <if test="param.orderByField == 1">
            order by ffpd.financeState
        </if>
    </select>

    <select id="getFinanceBondProduct" resultType="com.july.company.vo.finance.FinanceBondProductVo">
        select ffp.id,ffp.title,ffp.mechanism,ffpd.industryDirect,ffpd.loanQuota,ffpd.loanTerm from
        fc_finance_product ffp,fc_finance_bond_detail ffpd
        where
        ffp.id = ffpd.productId
        and ffp.financeType = 1
        and ffp.deleted = 0
        <if test="param.productIds != null and param.productIds != ''">
            and find_in_set(ffp.id,#{param.productIds})
        </if>
        <!--贷款期限-->
        <if test="param.loanTerm != null and param.loanTerm != ''">
            and ffpd.loanTerm = #{param.loanTerm}
        </if>
        <!--贷款额度-->
        <if test="param.loanQuota != null and param.loanQuota != ''">
            and ffpd.loanQuota = #{param.loanQuota}
        </if>
        <!--行业方向-->
        <if test="param.industryDirect != null and param.industryDirect != ''">
            and ffpd.industryDirect = #{param.industryDirect}
        </if>
        <!--股东背景-->
        <if test="param.shareholder != null and param.shareholder != ''">
            and ffpd.shareholder = #{param.shareholder}
        </if>
        <!--增信方式-->
        <if test="param.creditType != null and param.creditType != ''">
            and ffpd.creditType = #{param.creditType}
        </if>
        <!--企业资质-->
        <if test="param.qualification != null and param.qualification != ''">
            and ffpd.qualification = #{param.qualification}
        </if>
        <!--政府补贴-->
        <if test="param.subsidy != null and param.subsidy != ''">
            and ffpd.subsidy = #{param.subsidy}
        </if>
        <!--名称或机构名称-->
        <if test="param.mechanismOrProduct != null and param.mechanismOrProduct != ''">
            and (
            ffp.mechanism like concat('%',#{param.mechanismOrProduct},'%')
            or
            ffp.title like concat('%',#{param.mechanismOrProduct},'%')
            )
        </if>
        <if test="param.orderByField == null">
            order by ffpd.loanQuota desc
        </if>
        <if test="param.orderByField == 0">
            order by ffpd.loanTerm desc
        </if>
        <if test="param.orderByField == 1">
            order by ffpd.loanQuota desc
        </if>
    </select>

    <select id="getAllBondProduct" resultType="com.july.company.dto.finance.BondProductInfoDto">
        select ffp.id as productId,ffp.title,ffp.mechanism,ffpd.* from fc_finance_product ffp,fc_finance_bond_detail ffpd
        where
        ffp.id = ffpd.productId
        and ffp.financeType = 1
        and ffp.deleted = 0
    </select>

    <select id="getAllStockProduct" resultType="com.july.company.dto.finance.StockProductInfoDto">
        select ffp.id as productId,ffp.title,ffp.mechanism,ffpd.* from fc_finance_product ffp,fc_finance_stock_detail ffpd
        where
        ffp.id = ffpd.productId
        and ffp.financeType = 0
        and ffp.deleted = 0
    </select>

    <select id="getInstitutionProduct" resultType="com.july.company.entity.FinanceProduct">
        select ffp.* from fc_institution fi,fc_finance_product ffp
        where
        fi.id = ffp.institutionId
    </select>

    <select id="getProductGroupCount" resultType="com.july.company.dto.finance.ProductGroupDto">
        select ffp.financeType,count(ffp.id) as productCount from fc_finance_product ffp group by ffp.financeType
    </select>
    <select id="getStockList" resultType="com.july.company.vo.finance.FinanceStockProductDetailVo">
        select ffp.id,ffp.title,ffp.mechanism,ffp.workAddress,ffpd.industryDirect,ffpd.financeQuota,ffpd.financeState from
        fc_finance_product ffp,fc_finance_stock_detail ffpd
        where
        ffp.id = ffpd.productId
        and ffp.financeType = 0
        and ffp.deleted = 0
<!--        &lt;!&ndash;融资额度&ndash;&gt;-->
<!--        <if test="param.financeQuota != null and param.financeQuota != ''">-->
<!--            and ffpd.financeQuota = #{param.financeQuota}-->
<!--        </if>-->
<!--        &lt;!&ndash;融资阶段&ndash;&gt;-->
<!--        <if test="param.financeState != null and param.financeState != ''">-->
<!--            and ffpd.financeState = #{param.financeState}-->
<!--        </if>-->
<!--        &lt;!&ndash;行业方向&ndash;&gt;-->
<!--        <if test="param.industryDirect != null and param.industryDirect != ''">-->
<!--            and ffpd.industryDirect = #{param.industryDirect}-->
<!--        </if>-->
<!--        &lt;!&ndash;注册地址&ndash;&gt;-->
<!--        <if test="param.registerAddress != null and param.registerAddress != ''">-->
<!--            and ffpd.registerAddress = #{param.registerAddress}-->
<!--        </if>-->
<!--        &lt;!&ndash;营业收入&ndash;&gt;-->
<!--        <if test="param.business != null and param.business != ''">-->
<!--            and ffpd.business = #{param.business}-->
<!--        </if>-->
<!--        &lt;!&ndash;员工人数&ndash;&gt;-->
<!--        <if test="param.staffCount != null and param.staffCount != ''">-->
<!--            and ffpd.staffCount = #{param.staffCount}-->
<!--        </if>-->
<!--        &lt;!&ndash;市场占有率&ndash;&gt;-->
<!--        <if test="param.marketOccupyRate != null and param.marketOccupyRate != ''">-->
<!--            and ffpd.marketOccupyRate = #{param.marketOccupyRate}-->
<!--        </if>-->
<!--        &lt;!&ndash;评定名称&ndash;&gt;-->
<!--        <if test="param.evaluateName != null and param.evaluateName != ''">-->
<!--            and ffpd.evaluateName = #{param.evaluateName}-->
<!--        </if>-->
<!--        &lt;!&ndash;产品阶段&ndash;&gt;-->
<!--        <if test="param.productState != null and param.productState != ''">-->
<!--            and ffpd.productState = #{param.productState}-->
<!--        </if>-->
<!--        &lt;!&ndash;产品毛利率&ndash;&gt;-->
<!--        <if test="param.productRate != null and param.productRate != ''">-->
<!--            and ffpd.productRate = #{param.productRate}-->
<!--        </if>-->
<!--        &lt;!&ndash;实控人创业经历&ndash;&gt;-->
<!--        <if test="param.experience != null and param.experience != ''">-->
<!--            and ffpd.experience = #{param.experience}-->
<!--        </if>-->
<!--        &lt;!&ndash;发明专利数&ndash;&gt;-->
<!--        <if test="param.patentCount != null and param.patentCount != ''">-->
<!--            and ffpd.patentCount = #{param.patentCount}-->
<!--        </if>-->
<!--        &lt;!&ndash;股东背景&ndash;&gt;-->
<!--        <if test="param.shareholder != null and param.shareholder != ''">-->
<!--            and ffpd.shareholder = #{param.shareholder}-->
<!--        </if>-->
<!--        &lt;!&ndash;股东累计投入资金&ndash;&gt;-->
<!--        <if test="param.capitals != null and param.capitals != ''">-->
<!--            and ffpd.capitals = #{param.capitals}-->
<!--        </if>-->
<!--        &lt;!&ndash;公司竞争优势&ndash;&gt;-->
<!--        <if test="param.advantage != null and param.advantage != ''">-->
<!--            and ffpd.advantage = #{param.advantage}-->
<!--        </if>-->
<!--        &lt;!&ndash;历史创业企业状态&ndash;&gt;-->
<!--        <if test="param.companyStatus != null and param.companyStatus != ''">-->
<!--            and ffpd.companyStatus = #{param.companyStatus}-->
<!--        </if>-->
<!--        &lt;!&ndash;市场容量&ndash;&gt;-->
<!--        <if test="param.marketCapacity != null and param.marketCapacity != ''">-->
<!--            and ffpd.marketCapacity = #{param.marketCapacity}-->
<!--        </if>-->
<!--        &lt;!&ndash;市场预期容量增长率&ndash;&gt;-->
<!--        <if test="param.marketAddRate != null and param.marketAddRate != ''">-->
<!--            and ffpd.marketAddRate = #{param.marketAddRate}-->
<!--        </if>-->
<!--        &lt;!&ndash;市场占有率&ndash;&gt;-->
<!--        <if test="param.marketOccupyRate != null and param.marketOccupyRate != ''">-->
<!--            and ffpd.marketOccupyRate = #{param.marketOccupyRate}-->
<!--        </if>-->
<!--        &lt;!&ndash;是否接受回购条款&ndash;&gt;-->
<!--        <if test="param.boolBuyBack != null and param.boolBuyBack != ''">-->
<!--            and ffpd.boolBuyBack = #{param.boolBuyBack}-->
<!--        </if>-->
<!--        &lt;!&ndash;预计上市时间&ndash;&gt;-->
<!--        <if test="param.timeToMarket != null and param.timeToMarket != ''">-->
<!--            and ffpd.timeToMarket = #{param.timeToMarket}-->
<!--        </if>-->
<!--        &lt;!&ndash;营业收入增长率&ndash;&gt;-->
<!--        <if test="param.businessAddRate != null and param.businessAddRate != ''">-->
<!--            and ffpd.businessAddRate = #{param.businessAddRate}-->
<!--        </if>-->
<!--        &lt;!&ndash;过往融资金额&ndash;&gt;-->
<!--        <if test="param.oldFinanceQuota != null and param.oldFinanceQuota != ''">-->
<!--            and ffpd.oldFinanceQuota = #{param.oldFinanceQuota}-->
<!--        </if>-->
<!--        &lt;!&ndash;净利率&ndash;&gt;-->
<!--        <if test="param.netInterestRate != null and param.netInterestRate != ''">-->
<!--            and ffpd.netInterestRate = #{param.netInterestRate}-->
<!--        </if>-->
<!--        &lt;!&ndash;目标客户&ndash;&gt;-->
<!--        <if test="param.targetCustomer != null and param.targetCustomer != ''">-->
<!--            and ffpd.targetCustomer = #{param.targetCustomer}-->
<!--        </if>-->
<!--        &lt;!&ndash;名称或机构名称&ndash;&gt;-->
<!--        <if test="param.mechanismOrProduct != null and param.mechanismOrProduct != ''">-->
<!--            and (-->
<!--            ffp.mechanism like concat('%',#{param.mechanismOrProduct},'%')-->
<!--            or-->
<!--            ffp.title like concat('%',#{param.mechanismOrProduct},'%')-->
<!--            )-->
<!--        </if>-->
<!--        <if test="param.orderByField == null">-->
<!--            order by ffpd.financeQuota desc-->
<!--        </if>-->
<!--        <if test="param.orderByField == 0">-->
<!--            order by ffpd.financeQuota-->
<!--        </if>-->
<!--        <if test="param.orderByField == 1">-->
<!--            order by ffpd.financeState-->
<!--        </if>-->
    </select>
</mapper>
